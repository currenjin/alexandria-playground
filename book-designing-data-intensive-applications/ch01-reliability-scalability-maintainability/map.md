# Ch01 Reliability, Scalability, Maintainability
## TL;DR
- **품질**은 신뢰성, 확장성, 유지보수성의 균형으로 본다.
- 평균 대신 **백분위(p95, p99)**와 **오류율**로 측정한다.
- **신뢰성**은 결함이 발생해도 시스템이 올바르게 동작하고, 장애 전파를 막는 설계다.
- **확장성**은 캐시, 큐 그리고 수평확장 등 부하가 증가해도 좋은 성능을 유지하기 위한 전략이다.
- **유지보수성**은 레거시를 줄이고, 운용성, 단순성 그리고 발전성을 높이는 일이다.

## Key Ideas
- **결함**: 잘못될 수 있는 일이다. 결함을 예측하고 대처할 수 있는 시스템을 내결함성 또는 탄력성을 지녔다고 말한다.
- **부하 증가**: 성능 저하를 유발하는 가장 흔한 이유이다. 그리고 부하 매개변수를 정의할 수 있다.
- **응답 시간**: 온라인 시스템에서의 중요한 관심사다. 평균보다는 백분위(p95, p99, p999)를 사용하는 편이 좋다.
- **단순성**: 우발적 복잡도를 줄이고 좋은 추상화로 유지할 수 있다.

## Trade-offs

| 선택      | 장점                          | 단점                         | 언제                                        |
|---------|-----------------------------|----------------------------|-------------------------------------------|
| 수평 확장   | 탄력성과 확장성이 증가한다.             | 키/리밸런싱이 복잡하다.              | 고정적인 고부하 또는 대규모 데이터 발생 시 유용하다.            |
| 수직 확장   | 장점: 도입이 쉽고, 단일 노드 성능이 증가한다. | 단점: 상향의 한계가 있고, 비용이 급증한다.  | 언제 적용하는가: 일시적 스파이크가 발생하거나 간단한 워크로드에 유용하다. |
| 동기 처리   | 장점: 단순하고, 결과가 일관됐다.         | 단점: 지연 시간이 증가하고, 장애가 전파된다. | 언제 적용하는가: 강한 즉시성이 필요할 때 유용하다.             |
| 비동기 + 큐 | 장점: 스파이크를 흡수하거나 격리한다.       | 단점: 순서, 지연을 관리해야 한다.       | 언제 적용하는가: 쓰기 요청이 폭주하거나 후처리에 유용하다.         | 

## Apply our Domain
- 우리 서비스는 백분위 기준이 존재하지 않음
- p95 기준 정의하기 ex) `GET /orders?nearbyBaseOrderId -> p95: 500ms`
- 응답 시간 줄이기 ex) `GET /orders?nearbyBaseOrderId`

### SLI, SLO
- SLI
  - `orders.read.p95_ms`: `GET /orders` p95 응답시간
  - `orders.read.error_rate`: 5xx + 타임아웃/전체 요청
  - `cache.hit_rate.orders`: 주문 조회 캐시 히트율
- SLO (30 days)
  - `orders.read.p95_ms < 200`
  - `orders.read.error_rate < 0.1%`
  - `cache.hit_rate.orders >= 80%`

### Load Parameters
- TOP-N
- Cache Hit by Key
- Egress/Ingress

## Open Questions
- 부하 매개변수를 증가시키고 시스템 자원은 변경하지 않고 유지하면 시스템 성능은 어떻게 영향을 받을까?
- 부하 매개변수를 증가시켰을 때 성능이 변하지 않고 유지되길 원한다면 자원을 얼마나 많이 늘려야 할까?
- 캐시 TTL 1m/5m/10m에서 **p95, 히트율, 신선도 불만율**의 상관관계는?