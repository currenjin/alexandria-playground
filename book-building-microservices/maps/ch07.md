# Ch07. 빌드

## TL;DR
- 함께 일하는 모든 이들의 커뮤니케이션 리소스 및 불필요한 충돌을 방지하기 위해 CI/CD를 고려하라. 기존 코드가 새로 체크인한 코드와 통합되는지, 모든 체크인에 지속적인 피드백을 받는지 확인하는 방법이다.
- 소규모 팀이라면, 모노레포와 멀티레포 방식 모두 괜찮지만, 규모가 커질수록 멀티레포 방식이 더 간단할 것이다.

## Key Ideas
- Continuous Integration(지속적 통합): 모든 사람이 서로 조화롭게 동기화되도록 유지하는 것이 핵심 목표이다. 
  - 기존 코드와 새로 체크인한 코드가 적절히 통합되는지 코드 커밋을 감지하고, 체크아웃하며, 코드가 컴파일되고 테스트를 통과하는지 확인하는 등의 검증을 수행한다.
  - 메인라인에 하루에 한 번 체크인하는가? 변경 사항을 검증하는 일련의 테스트가 있는가? 빌드가 깨졌을 때 이를 수정하는 것이 팀의 최우선 일인가? 등을 고려하자.
  - 또한, 트렁크 기반 개발을 통해 브랜치 전략 중 GitFlow 방식과 같은 것을 고려하라.
- Continuous Delivery(지속적 제공): 모든 체크인의 운영 환경 준비 상태에 대한 지속적인 피드백을 받고 더 나아가 모든 체크인을 릴리스 후보로 취급하는 접근 방식이다.
  - Build Pipeline(빌드 파이프라인)과 같은 방식을 통해 느린 테스트보다 빠른 테스트를 먼저 검증해 피드백 속도를 높일 수 있다.
- Monorepo(모노레포): 여러 서비스를 담은 하나의 레포지토리 패턴. 하나의 서비스가 변경되면 모든 서비스의 빌드가 일어나지만, 락스텝을 적용하면 완벽하다. 하지만, 락스텝은 최대한 피하자.
- Multirepo(멀티레포): 서비스 별 단일 레포지토리 패턴. 개발자가 여러 레포지토리를 사용해 작업하는 경우 힘들고, 다른 레포지토리 코드에 의존하는 것을 막지 못한다.

## Open Questions
- 우리는 정말 CI/CD가 구축되어있는 환경인가? 각 단계에 해당하는 부분을 설명해보라.
- 지금은 웬만한 서비스는 모노레포로 멀티모듈 환경을 구성하여 커버할 수 있는 것 같다. 하지만, 멀티레포로 가면 좋은 순간이 언제일까?
  - 우리 팀이 커지고, 더이상 한 명이 모든 서비스를 커버할 수 없을 때이다. 이 경우 각 역할 별로 서비스를 맡을 것이고, 그 서비스에서 몰입해야 하는 기술의 깊이가 깊을 것이다.
  - 분리하게 되는 경우에는 생각보다 많은 리소스를 수반하므로, 신중히 고려해야 한다. 지금과 같은 상황에서는 공통 모듈에 대한 분리, 기존 CI/CD 연동, 레포지토리 권한 등이 있을 것이다.

## References
- [구글은 왜 수십억 줄의 코드를 단일 저장소에 저장하는가?](https://oreil.ly/wMyH3)
